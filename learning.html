<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Tiêu Hóa Thông Tin</title>
	<link rel="stylesheet" href="./public/plugins/fontawesome/css/all.min.css">
	<link rel="stylesheet" href="./public/plugins/sweetalert2/sweetalert2.min.css">
	<link rel="stylesheet" href="./public/css/adminlte.min.css">
	<link rel="stylesheet" href="./public/css/mystyle.css">
</head>

<body class="hold-transition sidebar-mini layout-navbar-fixed layout-fixed">

	<div class="wrapper">

		<nav class="main-header navbar navbar-expand border-bottom-0 text-sm navbar-light" id="header">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
				</li>
				<li class="nav-item d-none d-sm-inline-block">
					<a href="./" class="nav-link"><i class="fas fa-home"></i></a>
				</li>
			</ul>
			<ul class="navbar-nav ml-auto">
				<li class="nav-item">
					<a href="/calendar.html" class="nav-link" id="my-clock"><i class="far fa-clock"></i></a>
				</li>
				<li class="nav-item dropdown">
					<a class="nav-link" data-toggle="dropdown" href="#">
						<i class="far fa-comments"></i>
						<span class="badge badge-danger navbar-badge">0</span>
					</a>
				</li>
				<li class="nav-item dropdown">
					<a class="nav-link" data-toggle="dropdown" href="#">
						<i class="far fa-bell"></i>
						<span class="badge badge-warning navbar-badge">0</span>
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" data-widget="control-sidebar" data-slide="true" href="#" role="button">
						<i class="fas fa-th-large"></i>
					</a>
				</li>
			</ul>
		</nav>

		<aside class="main-sidebar sidebar-dark-primary elevation-4">
			<a href="./" class="brand-link text-md">
				<img src="https://graph.facebook.com/100007543845219/picture?height=100&width=100&access_token=6628568379%7Cc1e620fa708a1d5696fb991c1bde5662" class="brand-image img-circle elevation-3">
				<span class="brand-text font-weight-light" id="hello-user">MY LEARN</span>
			</a>
			<div class="sidebar">
				<div class="form-inline">
					<div class="input-group" data-widget="sidebar-search">
						<input class="form-control form-control-sidebar" type="search" placeholder="Search" aria-label="Search">
						<div class="input-group-append">
							<button class="btn btn-sidebar">
								<i class="fas fa-search fa-fw"></i>
							</button>
						</div>
					</div>
					<div class="sidebar-search-results">
						<div class="list-group">
						</div>
					</div>
				</div>
				<nav class="mt-2 text-sm">
					<ul class="nav nav-pills nav-sidebar flex-column nav-child-indent" data-widget="treeview" role="menu" data-accordion="false">
						<li class="nav-item">
							<a href="/home.html" class="nav-link ">
								<i class="nav-icon fas fa-tachometer-alt"></i><p>Ngôi Nhà Vĩ Nhân</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="/calendar.html" class="nav-link ">
								<i class="nav-icon fas fa-calendar-alt"></i><p>Lịch Treo Tường</p>
							</a>
						</li>
						<li class="nav-header text-warning">6. Áp dụng kiến thức</li>
						<li class="nav-item">
							<a href="/libraries.html" class="nav-link ">
								<i class="nav-icon fas fa-skating"></i><p>Thư Viện Cuộc Sống</p>
							</a>
						</li>
						<li class="nav-header text-warning">5. Tổng hợp kiến thức</li>
						<li class="nav-item">
							<a href="/knowledge.html" class="nav-link ">
								<i class="nav-icon fas fa-sitemap"></i><p>Xây Thành Đắp Lũy</p>
							</a>
						</li>
						<li class="nav-header text-warning">4. Phân tích thông tin</li>
						<li class="nav-item">
							<a href="/learning.html" class="nav-link active">
								<i class="nav-icon fas fa-rocket"></i><p>Tiêu Hóa Thông Tin</p>
							</a>
						</li>
						<li class="nav-header text-warning">3. Tóm tắt thông tin</li>
						<li class="nav-item">
							<a href="/classroom.html" class="nav-link ">
								<i class="nav-icon fas fa-chalkboard-teacher"></i><p>Lớp Học Quái Vật</p>
							</a>
						</li>
						<li class="nav-header text-warning">2. Tổ chức dữ liệu</li>
						<li class="nav-item">
							<a href="/courses.html" class="nav-link ">
								<i class="nav-icon fas fa-cubes"></i><p>Trèo Tường Vào Trường</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="/posts.html" class="nav-link ">
								<i class="nav-icon fas fa-cloud-sun"></i><p>Kho Tàng Tri Thức</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="/booking.html" class="nav-link ">
								<i class="nav-icon fas fa-book"></i><p>Từ Sách Đến Đời</p>
							</a>
						</li>
						<li class="nav-header text-warning">1. Thu thập dữ liệu</li>
						<li class="nav-item">
							<a href="/timeline.html" class="nav-link ">
								<i class="nav-icon fas fa-pencil-alt"></i><p>Nhật Ký Ý Tưởng</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="/crawler.html" class="nav-link ">
								<i class="nav-icon fas fa-leaf"></i><p>Duyệt Kinh Điển</p>
							</a>
						</li>
						<li class="nav-header">------------------</li>
						<li class="nav-item">
							<a href="/backup.html" class="nav-link ">
								<i class="nav-icon fas fa-dove"></i><p>Trường Sinh Bất Lão</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="/signin.html" class="nav-link">
								<i class="nav-icon fas fa-sign-in-alt"></i><p>Đăng Nhập</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="#" class="nav-link" id="sign-out">
								<i class="nav-icon fas fa-sign-out-alt"></i><p>Đăng Xuất</p>
							</a>
						</li>
					</ul>
				</nav>
			</div>
		</aside>

		<aside class="control-sidebar control-sidebar-dark">
			<div class="p-3">
				<h5>Thanh Công Cụ</h5>
				<div class="mb-4"><input type="checkbox" id="dark-mode" class="mr-1"><span>Dark Mode</span></div>
				
				<button class="btn btn-sm btn-default" id="fast-highlight"><span class="badge bg-success" id="fast-number"></span> <i class="fas fa-spell-check"></i> highlight</button>
				<textarea class="form-control" id="fast-content" rows="8"></textarea>
				<select class="form-control" id="fast-categories">
				</select>
				<select class="form-control" id="fast-courses">
				</select>
				<button class="btn btn-sm btn-primary" id="fast-knowledge"><i class="fas fa-edit"></i> Kiến Tạo</button>
			</div>
		</aside>

		<div class="content-wrapper">
			<div class="content">
				<div class="row">
					<div class="col-sm-4">
						<div class="card">
							<div class="card-header">
								<h3 class="card-title">Nguyên Liệu</h3>
							</div>
							<div class="card-body table-responsive p-0">
								<table class="table table-sm table-hover table-head-fixed">
									<thead>
										<tr>
											<th>
												<div class="row">
													<div class="col-sm-6"><select class="form-control" id="kitchen-categories"></select></div>
													<div class="col-sm-6"><select class="form-control" id="kitchen-courses"></select></div>
												</div>
											</th>
										</tr>
									</thead>
									<tbody id="kitchen-informations">
									</tbody>
								</table>
							</div>
						</div>
					</div>
					<div class="col-sm-8">
						<div class="card card-default" id="card-learning">
							<div class="card-header">
								<h3 class="card-title">Tư Duy Chuyển Hóa</h3>
								<div class="card-tools">
									<button type="button" class="btn btn-primary btn-xs" id="button-save-2">Lưu vào</button>
									<button type="button" class="btn btn-tool" data-card-widget="maximize">
										<i class="fas fa-expand"></i>
									</button>
									<button type="button" class="btn btn-tool" data-card-widget="collapse">
										<i class="fas fa-minus"></i>
									</button>
									<button type="button" class="btn btn-tool" data-card-widget="remove">
										<i class="fas fa-times"></i>
									</button>
								</div>
							</div>
							<div class="card-body">
								<h5 class="text-info">Tiếp thu/Cảm nhận:</h5>
								<div class="form-group">
									<label for="think_know">1. <code data-toggle="tooltip" title="Tôi biết gì? tôi thấy gì? cảm nhận riêng của tôi?"><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_know" rows="1" placeholder="nghe, nhìn, tiếp xúc, ngửi, nếm, cảm nhận ..."></textarea>
								</div>

								<h5 class="text-info">Suy nghĩ:</h5>
								<div class="form-group">
									<label for="think_what">1. What <code data-toggle="tooltip" title="Nó là gì, cái gì, con gì, cái nào, điều gì? Cái gì xảy ra? Có thành phần gì? Cái gì quan trọng? Cái gì còn thiếu? khó khăn gì? thuận lợi gì? cần làm gì? ý nghĩa là gì? Cái gì ... nếu ..., động cơ gì? kết luận gì? mục đích gì?"><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_what" rows="1" placeholder=". . ."></textarea>
								</div>
								<div class="form-group">
									<label for="think_when">2. When <code data-toggle="tooltip" title="Khi nào? khoảnh khắc? khi nào biết...? khi nào là tốt nhất?"><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_when" rows="1" placeholder=". . ."></textarea>
								</div>
								<div class="form-group">
									<label for="think_where">3. Where <code data-toggle="tooltip" title="Ở đâu? từ đâu đến? bắt đầu từ đâu? đi đâu?"><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_where" rows="1" placeholder=". . ."></textarea>
								</div>
								<div class="form-group">
									<label for="think_who">4. Who <code data-toggle="tooltip" title="Ai đã nói/viết? nói về ai? những người tham gia? ai gây ra? ai bị hại? ai quan trọng nhất? ai chịu trách nhiệm? Ai nên...? Ai được lợi? ai bị ảnh hưởng? ai quyết định?"><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_who" rows="1" placeholder=". . ."></textarea>
								</div>
								<div class="form-group">
									<label for="think_why">5. Why <code data-toggle="tooltip" title="Tại sao? Tại sao nó quan trọng? Tại sao tôi phải tin? tại sao cần thiết?"><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_why" rows="1" placeholder=". . ."></textarea>
								</div>
								<div class="form-group">
									<label for="think_how">6. How <code data-toggle="tooltip" title="Như thế nào? hình thành như thế nào? định nghĩa như thế nào? làm thế nào nhận ra? bao nhiêu? giải quyết ntn? ra sao?"><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_how" rows="1" placeholder=". . ."></textarea>
								</div>

								<h5 class="text-info">Điều tra:</h5>
								<div class="form-group">
									<label for="think_investigative">1.  <code data-toggle="tooltip" title="(nguyên nhân, diễn biến, nguồn gốc, quá trình, kết quả, lịch sử, dự đoán, giả thuyết), nó ở trong quá trình nào, ai sinh ra nó, nó tạo ra gì, đầu ra vào của nó, tính chất của nó, hệ quả của nó? những thứ tương tự? lịch sử của nó?"><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_investigative" rows="1" placeholder=". . ."></textarea>
								</div>

								<h5 class="text-info">Mở rộng:</h5>
								<div class="form-group">
									<label for="think_expansive">1.  <code data-toggle="tooltip" title="nó có phải duy nhất? có cách nào khác? theo 1 cách khác? có thể áp dụng cái này sang ...? tiếp theo là gì? hôm nay? ngày mai? mặt khác là gì? giải pháp thay thế? điều ta biết người cũng biết vậy sự khác biệt là gì?"><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_expansive" rows="1" placeholder=". . ."></textarea>
								</div>

								<h5 class="text-info">Phản biện/Tranh luận:</h5>
								<div class="form-group">
									<label for="think_critical">1.  <code data-toggle="tooltip" title="khi nào nó sai? cái gì làm nó sai? sai lầm phổ biến? mặt trái? cái gì chống lại nó? không có nó thì sao? ..."><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_critical" rows="1" placeholder=". . ."></textarea>
								</div>

								<h5 class="text-info">So sánh/Liên hệ:</h5>
								<div class="form-group">
									<label for="think_comparative">1.  <code data-toggle="tooltip" title="nó vs ..? nó vs ...? nó vs ...? ... giống và khác nhau"><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_comparative" rows="1" placeholder=". . ."></textarea>
								</div>

								<h5 class="text-info">Thể hiện, diễn đạt:</h5>
								<div class="form-group">
									<label for="think_performance">1.  <code data-toggle="tooltip" title="hình ảnh, vẽ, mô hình, biểu đồ, sơ đồ tư duy, đơn giản hóa, ... chuyển hóa thành dạng nghe, nhìn"><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_performance" rows="1" placeholder=". . ."></textarea>
								</div>

								<h5 class="text-info">Thử nghiệm:</h5>
								<div class="form-group">
									<label for="think_testing">1. idea, issus <code data-toggle="tooltip" title="ý tưởng khác, vấn đề khác, khả năng khác, điều gì xảy ra nếu, có lên..."><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_testing" rows="1" placeholder=". . ."></textarea>
								</div>

								<h5 class="text-info">Bắt chước/mô phỏng:</h5>
								<div class="form-group">
									<label for="think_simulation">1.  <code data-toggle="tooltip" title="viết, nói, vẽ, hát, tưởng tượng, lẩm nhẩm, ..."><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_simulation" rows="1" placeholder=". . ."></textarea>
								</div>

								<h5 class="text-info">Tương tác:</h5>
								<div class="form-group">
									<label for="think_interactive">1.  <code data-toggle="tooltip" title="dạy lại, trao đổi vs bạn bè, hỏi ý kiến, đặt câu hỏi, tham gia nhóm, câu lạc bộ..."><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_interactive" rows="1" placeholder=". . ."></textarea>
								</div>

								<h5 class="text-info">Trải nghiệm:</h5>
								<div class="form-group">
									<label for="think_experience">1.  <code data-toggle="tooltip" title="tìm cách để được tham gia thật"><i class="fas fa-question-circle"></i></code></label>
									<textarea class="form-control form-control-border" id="think_experience" rows="1" placeholder=". . ."></textarea>
								</div>
								<div class="form-group">
									<button type="button" class="btn btn-primary" id="button-save-1">Lưu lại</button>
								</div>

							</div>
						</div>

					</div>
				</div>
			</div>
		</div>

		<footer class="main-footer">
			<div class="text-center">** Cắp sách đi học Trường Đời - Cố thêm 1 Chút thôi - Thừa hơn Thiếu **</div>
		</footer>
	</div>
	<div id="back-to-top" onclick="backToTop()"><i class="fa fa-chevron-up"></i></div>
	<script src="./public/plugins/jquery/jquery.min.js"></script>
	<!-- The core Firebase JS SDK is always required and must be listed first -->
	<script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-auth.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-database.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-firestore.js"></script>
	<script src="./public/plugins/moment/moment.min.js"></script>
	<script src="./public/plugins/sweetalert2/sweetalert2.min.js"></script>
	<script src="./public/plugins/bootstrap/bootstrap.bundle.min.js"></script>
	<script src="./public/js/adminlte.min.js"></script>
	<script src="./public/js/myfirebase.js"></script>
	<script src="./public/js/myscript.js"></script>
	<script type="text/javascript">

		var study_id = null;
		var course_id = null;

		$('[data-toggle="tooltip"]').tooltip();

		GetCategories();

		// chọn chủ để -> tải khóa học
		$('#kitchen-categories').change(function ()
		{
			var category_id = $(this).val();
			GetCourses(category_id)
		})
		// lấy danh sách study của khóa học
		$('#kitchen-courses').change(function ()
		{
			course_id = $(this).val();
			GetStudy(course_id);

			//$('#card-learning').CardWidget('collapse');
		})
		// lưu lại
		$('#button-save-1, #button-save-2').click(function ()
		{
			var button = this;
			var content = $('tr#' + study_id + ' td.text-primary').text();

			var think_know = $('#think_know').val().trim();
			var think_what = $('#think_what').val().trim();
			var think_when = $('#think_when').val().trim();
			var think_where = $('#think_where').val().trim();
			var think_who = $('#think_who').val().trim();
			var think_why = $('#think_why').val().trim();
			var think_how = $('#think_how').val().trim();
			var think_investigative = $('#think_investigative').val().trim();
			var think_expansive = $('#think_expansive').val().trim();
			var think_critical = $('#think_critical').val().trim();
			var think_comparative = $('#think_comparative').val().trim();
			var think_performance = $('#think_performance').val().trim();
			var think_testing = $('#think_testing').val().trim();
			var think_simulation = $('#think_simulation').val().trim();
			var think_interactive = $('#think_interactive').val().trim();
			var think_experience = $('#think_experience').val().trim();

			if (!study_id)
			{
				return;
			}
			if (!think_know && !think_what && !think_when && !think_where && !think_who && !think_why && !think_how && !think_investigative && !think_expansive && !think_critical && !think_comparative && !think_performance && !think_testing && !think_simulation && !think_interactive && !think_experience)
			{
				return;
			}
			$(button).removeClass('btn-primary').removeClass('btn-warning').html('<i class="fas fa-spinner fa-spin"></i>');

			let created_at = moment().unix();

			// id study cũng là id knowledge
			fsdb.collection("knowledges").doc(study_id).set({
				content: content,
				think_know: think_know,
				think_what: think_what,
				think_when: think_when,
				think_where: think_where,
				think_who: think_who,
				think_why: think_why,
				think_how: think_how,
				think_investigative: think_investigative,
				think_expansive: think_expansive,
				think_critical: think_critical,
				think_comparative: think_comparative,
				think_performance: think_performance,
				think_testing: think_testing,
				think_simulation: think_simulation,
				think_interactive: think_interactive,
				think_experience: think_experience,
				created_at: created_at,
				index: 0,
				tags: null
			})
			.then((docRef) => {
				$(button).addClass('btn-primary').html('Lưu vào');
			})
			.catch((error) => {
				console.log(error);
				$(button).addClass('btn-warning').html('Lưu lỗi');
			});
		})

		// lấy danh sách lĩnh vực
		function GetCategories()
		{
			$('#kitchen-categories').html('<option value="">-- chọn chủ đề --</option>');
			fsdb.collection("categories").orderBy("index", "asc").get()
			.then((querySnapshot) => {
				querySnapshot.forEach((doc) => {
					let docid = doc.id;
					let docdata = doc.data();

					var code = '<option value="' + docid + '">' + docdata.category + '</option>';
					$('#kitchen-categories').append(code);
				});
			})
			.catch((error) => {
				console.log(error);
			});
		}
		// lấy danh dách toàn bộ khóa học
		function GetCourses(docid)
		{
			category_id = docid;
			$('#kitchen-courses').html('<option value="">-- chọn khóa học --</option>');
			fsdb.collection("courses").where('category_id', '==', category_id).orderBy("index", "asc").get()
			.then((querySnapshot) => {
				querySnapshot.forEach((doc) => {
					let docid = doc.id;
					let docdata = doc.data();
					var code = '<option value="' + docid + '">' + docdata.course + '</option>';
					$('#kitchen-courses').append(code);
				});
			})
			.catch((error) => {
				console.log(error);
			});
		}
		// lấy danh sách thông tin
		function GetStudy(course_id)
		{
			DisBox(true);

			fsdb.collection("informations").where('course_id', '==', course_id).orderBy("created_at", "asc").get()
			.then((querySnapshot) => {
				let code = '';
				querySnapshot.forEach((doc) => {
					let docid = doc.id;
					let docdata = doc.data();

					code += '<tr id="' + docid + '"><td class="" onclick="StudyLearning(this)">' + docdata.study + '<small class="float-right" onclick="DeleteStudy(this)"><i class="fas fa-trash-alt text-gray"></i></small></td></tr>';
				});
				$('#kitchen-informations').html(code);
			})
			.catch((error) => {
				console.log(error);
				$('#kitchen-informations').html('<i class="fas fa-exclamation-triangle"></i>');
			});
		}
		// load learning cho study
		function StudyLearning(element)
		{
			study_id = $(element).parent().attr('id');
			DisBox(false);

			// reset form
			$('#think_know').val('');
			$('#think_what').val('');
			$('#think_when').val('');
			$('#think_where').val('');
			$('#think_who').val('');
			$('#think_why').val('');
			$('#think_how').val('');
			$('#think_investigative').val('');
			$('#think_expansive').val('');
			$('#think_critical').val('');
			$('#think_comparative').val('');
			$('#think_performance').val('');
			$('#think_testing').val('');
			$('#think_simulation').val('');
			$('#think_interactive').val('');
			$('#think_experience').val('');

			$('#kitchen-informations tr td').removeClass('text-primary').css('background-color', '');
			$(element).css('background-color', 'gold');
			$('#card-learning').CardWidget('expand');

			// get form data
			fsdb.collection("knowledges").doc(study_id).get().then((doc) => {
				if (doc.exists)
				{
					let docdata = doc.data();
					$('#think_know').val(docdata.think_know);
					$('#think_what').val(docdata.think_what);
					$('#think_when').val(docdata.think_when);
					$('#think_where').val(docdata.think_where);
					$('#think_who').val(docdata.think_who);
					$('#think_why').val(docdata.think_why);
					$('#think_how').val(docdata.think_how);
					$('#think_investigative').val(docdata.think_investigative);
					$('#think_expansive').val(docdata.think_expansive);
					$('#think_critical').val(docdata.think_critical);
					$('#think_comparative').val(docdata.think_comparative);
					$('#think_performance').val(docdata.think_performance);
					$('#think_testing').val(docdata.think_testing);
					$('#think_simulation').val(docdata.think_simulation);
					$('#think_interactive').val(docdata.think_interactive);
					$('#think_experience').val(docdata.think_experience);
				}
			}).catch((error) => {
				console.log(error);
			});
		}
		// xóa 1 thông tin
		function DeleteStudy(element)
		{
			study_id = $(element).parents('tr').attr('id');

			if (!confirm('Xóa thông tin?'))
			{
				return;
			}

			fsdb.collection("informations").doc(study_id).delete().then(() => {
				DisBox(true);
				GetStudy(course_id);
			}).catch((error) => {
				console.log(error);
			});
		}
		// vo hieu hóa nhập
		function DisBox(bool)
		{
			$('div.form-group textarea').val('').prop('disabled', bool);
			$('#button-save-1').prop('disabled', bool);
			$('#button-save-2').prop('disabled', bool);
		}
</script>
</body>
</html>