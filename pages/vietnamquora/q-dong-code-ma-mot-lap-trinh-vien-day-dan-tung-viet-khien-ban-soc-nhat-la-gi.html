<div>781<br><br>#codingTrick #CprogrammingLanguage #vmc<br><br>Q: Dòng code mà một lập trình viên dày dặn từng viết khiến bạn sốc nhất là gì?<br><br>A: Micha Berger, từng học tại Dại học Yeshiva<br><br>=============<br><br>#define swap(x, y) (x ^= y ^= x ^= y)<br><br>Đó là một macro tiền xử lý trong C, tức là bạn sẽ thấy thứ gì đó đại loại kiểu<br><br>swap(**this**, that);<br><br>trong code của bạn, và trình biên dịch C nhận được từ bộ tiền xử lý đoạn mã<br><br>(**this** ^= that ^= **this** ^= that);<br><br>để biên dịch. Bạn không cần phải khai báo một biến tạm (temporary) như bạn sẽ làm trong phần lớn những đoạn mã thực hiện swap, nó không mang kiểu rõ ràng (type specific) và đoạn mã sẽ chạy với bất kỳ kiểu dữ liệu nào hỗ trợ toán tử exclusive or (XOR). Tôi sẽ giải thích một chút về cách hoán đổi của nó, song tại sao bạn không thử tự mình làm phép toán boolean nhỉ? (Tôi sẽ đưa vào trong comment đầu tiên) Và<br><br>Đây là đoạn mã bị lỗi khiến chúng ta phải xem xét lại:<br><br>swap(arr[i], arr[j]);<br><br>Trong trường hợp i == j thì.  arr[i] và arr[j] là cùng một biến trong bộ nhớ và toán tử “^=” đầu tiên sẽ ghi đè lên cả hai. Từ đó: arr[i] == arr[j] == 0.<br><br>Vậy, nó chỉ chạy khi hai biến chỉ đến những địa chỉ khác nhau trong bộ nhớ thôi nhé.<br><br>Dù rất sốc vì mức độ thông minh của nó, song nó vẫn cực ngu.<br><br>[COMMENT]<br> Logic là như sau. Tôi sẽ tách ra các mỗi phần tương ứng của x và y (ta lấy x, biến thành x’, và thành x’’... Tương tự với y’).<br><br>{x’ = x ^ y}<br>{y’ = x’ ^ y == x ^ y ^ y == x}<br>{x’’ == x’ ^ y’ == x ^ y ^ x == y}<br><br>Vì thếm, bạn chỉ còn biến {x} giữ giá trị {y} và biến {y} giữ giá trị ban đầu của {x}.<br><br>Song, trong trường hợp macro này gặp lỗi ấy, viết rộng ra sẽ là<br>(array[i] ^= array[j] ^= array[i] ^= array[j])<br><br>Chậc, ví dụ {i == j == 2} chẳng hạn, thì sẽ là:<br>(array[2] ^= array[2] ^= array[2] ^= array[2])<br>và phép gán đầu tiên ấy là<br>array[2]’ = array[2] ^ array[2] == 0<br>— lúc này bạn đã gán cả “x” và “y” mất rồi! Vì vậy, mọi thứ còn lại sẽ chỉ là<br>array[2]’’ = 0 ^ 0 = 0<br><br>[[LINK]](https://www.quora.com/What-is-the-most-shocking-line-of-code-youve-seen-a-seasoned-programmer-write/answer/Micha-Berger)<br><br><img src='https://scontent.fhan17-1.fna.fbcdn.net/v/t1.6435-9/69259139_2433106266935927_3509093155343433728_n.jpg?stp=dst-jpg_s720x720&_nc_cat=102&ccb=1-7&_nc_sid=ca434c&_nc_ohc=icJ9c8aU0uUAX95i9PA&_nc_ht=scontent.fhan17-1.fna&edm=AFuVL-cEAAAA&oh=00_AfCR6HkaxiZbce7iYYzEuW6qs7LyuUkCmK8FdEtDDD9iJw&oe=63D0D344'></div>