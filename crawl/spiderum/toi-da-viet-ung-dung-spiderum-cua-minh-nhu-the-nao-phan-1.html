<div class="p-content"><div><br><em>&nbsp; &nbsp; Mở đầu, bài viết này thuật lại quá trình mình viết ứng dụng đọc spiderum của riêng mình, ứng dụng không nhằm mục đích thương mại hay được release lên store nào cả, mục tiêu học tập chia sẻ là chính. Toàn bộ source code của ứng dụng available at <a href="https://github.com/zrg-team/rn_spiderum" target="_blank">https://github.com/zrg-team/rn_spiderum</a>.</em><em><u><br><br></u></em></div><div>&nbsp; &nbsp; <em>Do thời gian viết ngắn và chưa có thời gian trau chuốt nên ứng dụng có thể còn tồn tại bugs và code chưa được optimaze tốt. Feel free to help me</em></div><div><em><u><strong>Ủ</strong></u><strong><u>ng hộ offical application từ spiderum nhé !</u></strong></em></div><div><div><br></div><figure class="aligncenter"><img src="https://s3-ap-southeast-1.amazonaws.com/images.spiderum.com/sp-images/da501690101911eabf79ff23ff2ce186.png"><figcaption class="image-description" placeholder="Chú thích ảnh (không bắt buộc)" contenteditable="false"><br></figcaption></figure></div><h4><br>I. Bối cảnh</h4><div>&nbsp; &nbsp; Tôi có thói quen đọc spiderum mỗi khi có thời gian rãnh : trong lúc trên xe bus đến công ty, trong lúc đi bộ đi ăn trưa, hoặc ngồi đợi một thứ gì đó, ...<br>Website spiderum hiện tại cũng tối ưu rất tốt giao diện mobile, tuy nhiên nó không hỗ trợ offline và cũng có bố cục theo phong cách máy tính</div><div><br>&nbsp; &nbsp; Tôi cũng mò mẫm trên playstore: có một vài ứng dụng không chính thức thì kết quả là ứng dụng hoặc chậm hoặc xấu hoặc không làm việc trong tình trạng ngắt mạng thứ mà tôi cần nhất cho một ứng dụng mobile. Vậy nên tôi quyết định tự viết một ứng dụng nhỏ để đọc spiderum cho riêng mình, tất nhiên là mình cũng không có ý định kiếm thu nhập hay public ứng dụng lên store gì cả</div><div><br></div><h4>II. Mục tiêu</h4><div>&nbsp; Mục tiêu mà tôi hướng đến khi xây dựng ứng dụng :</div><div><br>&nbsp; + Giao diện đơn giản, dễ dùng</div><div><br>&nbsp; + Tải bài viết nhanh</div><div><br>&nbsp; + Hỗ trợ đọc offine</div><div><br>&nbsp; + Trải nghiệm đọc tốt</div><div><br>&nbsp; + Ứng dụng sinh động</div><div><br>&nbsp; + Thời gian khởi động ứng dụng ngắn</div><div><br><br>&nbsp; &nbsp; Bên cạnh đó là một vài yêu cầu phi nghiệp vụ : có thể chạy trên cả android và ios, ứng dụng dễ fix bugs, mở rộng, thơi gian mở ứng dụng nhanh, không bị crash , ...</div><div><br></div><div>&nbsp; &nbsp; Ngoài ra thời gian hoàn thiện cũng không được quá dài, vì mình cũng đang bận bịu với công việc của công ty và dự án của bản thân. Thời gian mà mình estimate cho project này vào khoảng 16h</div><h4><br>III. Xắn tay áo lên nào</h4><div>&nbsp; &nbsp; Có khoảng 14 - 16h để hoàn thành</div><div><br>&nbsp; &nbsp; &nbsp;Để viết ứng dụng cho mobile thì có một số công nghệ mà mình có thể cân nhắc đến:</div><div><br>&nbsp;+ Cordova: CSS HTML JS, một vài module native. Là một công nghệ cross-platform lâu đời nó sẽ giúp tốc độ xây dựng ứng dụng nhanh, nguồn tham khảo nhiều, tuy nhiên hiệu năng của nó sẽ chậm và công nghệ cũng cũ kĩ</div><div><br>&nbsp;+ PWA: CSS HTML JS same as Cordova, CSS HTML JS, cho phép cài ứng dụng trực tiếp từ website nhưng về cơ bản vẫn hoạt động trên một trình duyệt. Và khả năng đưa lên ios cũng chưa rõ ràng</div><div><br>&nbsp;+ Native: Nhanh , mạnh gần như hoàn hảo chỉ tội khó mà có thể hoàn thiện ứng dụng cho android và ios trong 16h ít ỏi</div><div><br>&nbsp;+ React-native: Cross-platform cộng đồng nhiều, tutorial nhiều, performance tốt (tuy không bằng flutter và native).</div><div><br>&nbsp;+ Flutter: Mới lạ, hiệu năng tốt, cách viết cũng hiện đại, dễ làm quen. Thư viện, cộng đồng thì chưa được như react-native hay native</div><div><br>&nbsp; &nbsp; Thời gian không có nhiều mình dành 1 giờ hoặc hơn để tìm các ứng dụng tương tự xem chúng viết bằng gì, dạo quanh xem có template nào để có thể xây dựng nó nhanh không ? Cuối cùng thời gian không có nhiều mình lựa chọn 1 nền tảng thân thuộc mong là nó giúp mình đẩy nhanh quá trình phát triển. Mình cũng đọc được 1 số đánh giá tích cực trên các phiên bản mới của react-native 0.6x nên cũng muốn thử =&gt; Done REACT-NATIVE and 15h còn lại</div><div><br><strong>1. Codebase</strong></div><div>&nbsp; &nbsp; Đã làm việc với react-native từ trước nên codebase không phải vấn đề lớn với mình. Code base mà mình đã xây dựng từ lâu và áp dụng cho hầu hết các công ty mà mình đã từng đi qua. Mục tiêu cơ bản của nó là: cấu trúc hướng module, dễ phát triển và debug, dễ dàng để phân chia công việc, hướng đến việc tối ưu hiệu năng bằng việc giảm quá trình render, singleton những thành phần hay dùng ...<br><br></div><ul><li data-sourcepos="17:3-17:49">assets: dữ liệu cứng trong ứng dụng bao gồm hình ảnh, json file, etc</li><li data-sourcepos="18:3-18:74">common: Components, functions chung</li><li data-sourcepos="19:3-19:47">configs: nothing to say</li><li data-sourcepos="20:3-20:139">modules: Mỗi ứng dụng sẽ được tạo thành từ nhiều module, bên trong mỗi module sẽ bao gồm các thành phần độc lập của riêng nó bao gồm state, endpoint, config, components, etc</li><li data-sourcepos="21:3-23:0">pages: Các trang của ứng dụng&nbsp;</li></ul><div><br></div><div>&nbsp; &nbsp; Source code ban đầu đã được lên xong trong tầm 15 - 30 phút</div><div><br>&nbsp; &nbsp; Codebase như trên cũng có thể ứng dụng cho PWA, Server Side Rendering Web, Flutter, etc</div><div><div class="scrape-url" contenteditable="false"><a class="scrape-info" href="https://github.com/zrg-team/demo_frontend" rel="nofollow" target="_blank"><strong class="markup-strong">zrg-team/demo_frontend</strong><br><em class="markup-em">Contribute to zrg-team/demo_frontend development by creating an account on GitHub.</em>github.com</a><a class="scrape-thumb" target="_blank" rel="nofollow" href="https://github.com/zrg-team/demo_frontend" style="background-image:url(https://s3-ap-southeast-1.amazonaws.com/images.spiderum.com/sp-images/0c1d7440102611eaa8085d69f5fc0785.png);"></a></div></div><div><div class="scrape-url" contenteditable="false"><a class="scrape-info" href="https://github.com/zrg-team/pwa-demo" rel="nofollow" target="_blank"><strong class="markup-strong">zrg-team/pwa-demo</strong><br><em class="markup-em">Contribute to zrg-team/pwa-demo development by creating an account on GitHub.</em>github.com</a><a class="scrape-thumb" target="_blank" rel="nofollow" href="https://github.com/zrg-team/pwa-demo" style="background-image:url(https://s3-ap-southeast-1.amazonaws.com/images.spiderum.com/sp-images/0cddb700102611eab354af7512807285.png);"></a></div></div><div><div class="scrape-url" contenteditable="false"><a class="scrape-info" href="https://github.com/zrg-team/quick-chat" rel="nofollow" target="_blank"><strong class="markup-strong">zrg-team/quick-chat</strong><br><em class="markup-em">Chat application powered by firebase, ipfs and cryptography. - zrg-team/quick-chat</em>github.com</a><a class="scrape-thumb" target="_blank" rel="nofollow" href="https://github.com/zrg-team/quick-chat" style="background-image:url(https://s3-ap-southeast-1.amazonaws.com/images.spiderum.com/sp-images/0fc2ae80102611ea887403bbdcfba5c0.png);"></a></div></div><div><div class="scrape-url" contenteditable="false"><a class="scrape-info" href="https://github.com/zrg-team/flutter_redux" rel="nofollow" target="_blank"><strong class="markup-strong">zrg-team/flutter_redux</strong><br><em class="markup-em">A Flutter Starter Application. Contribute to zrg-team/flutter_redux development by creating an account on GitHub.</em>github.com</a><a class="scrape-thumb" target="_blank" rel="nofollow" href="https://github.com/zrg-team/flutter_redux" style="background-image:url(https://s3-ap-southeast-1.amazonaws.com/images.spiderum.com/sp-images/0fab55f0102611eaa39b41b9934d9bc9.png);"></a></div></div><div><br></div><div>&nbsp; &nbsp; Công nghệ sử dụng: react, redux, redux-saga, react-navigation, ...</div><div><br>&nbsp; &nbsp; Sau khi có source base mình dành 1 ít thời gian để tối ưu và check xem có đáp ứng được nhu cầu sử dụng không ? Với mình một ứng dụng tốn quá 3s để mở trang đầu tiên đều là do ứng dụng có vấn đề. Có thể bạn cần load nhiều api hay authentication gì đó nhưng theo mình cứ show lên sau đó hiển thị update mới sau hoặc hiển thị lỗi sau đó thì tốt hơn (đây là ý kiến cá nhân của mình)<br><br><strong>2. Xây dựng các trang&nbsp;</strong></div><div>&nbsp; &nbsp; Để bắt tay vào làm việc mình phải hình dung được trong đầu rằng ứng dụng sẽ mở lên như thế nào, người dùng sẽ chọn tin như thế nào và đọc tin như thế nào, công việc mà họ có thể làm trên ứng dụng, khi ứng dụng không có mạng thì nó sẽ hoạt động như thế nào ? etc<br><br>&nbsp; &nbsp; Nhìn vào trang chủ của spiderum mình thấy các phần mà bản thân mình quan tâm nhất: bài viết mới, bài viết đang nóng, bài viết có nhiều người đọc nhất . Ok Mình sẽ show hết tất cả chúng ra ngay khi người dùng vào ứng dụng , vậy thì màn hình chính của ứng dụng sẽ bao gồm các tab và mỗi tab sẽ chứa bài viết theo từng phần như trên, Vậy màn hình chủ sẽ bao gồm các tab sau :</div><div><br>&nbsp; + Bài viết hot: tất nhiên ai mà chẳng muốn đọc bài viết đang hot</div><div><br>&nbsp; + Bài viết mới</div><div><br>&nbsp; + Bài viết top</div><div><br>&nbsp; + Danh sách categories: yes mình thường đọc bài viết trong 1 số chủ để ưa thích nên màn hình này cũng cực kì quan trọng</div><div><br>&nbsp; + Options</div><div><br>&nbsp;Một số màn hình có thể có : trang bookmark, thay đổi theme, trang thông tin của người viết, etc<br><br><strong>a. Trang danh sách&nbsp;bài viết</strong><br><figure class="alignright"><img src="https://s3-ap-southeast-1.amazonaws.com/images.spiderum.com/sp-images/92c28c500f8211ea8c0a1d0af190a2a5.png" class="fr-fic fr-dib"><figcaption class="image-description" placeholder="Chú thích ảnh (không bắt buộc)" contenteditable="false"><br></figcaption></figure></div><div>&nbsp; Đây là trang chủ đạo của ứng dụng , ngay từ đầu mình xác định đây là màn hình mà người dùng (mình) sẽ gặp và tương tác nhiều nhất.</div><div><br>&nbsp; &nbsp; Danh sách bài viết phải rõ ràng và đầy đủ thông tin. Không giống như các ứng dụng đọc tin tức, danh sách thường tập trung tối ưu để hiển thị nhiều tin tức nhất có thể, giảm lược description, thông tin của author, số lượng bình luận, lượt xem, làm nhỏ hình ảnh etc . Bản thân mình luôn coi việc lựa chọn bài viết để đọc là một giai đoạn rất quan trọng trên spiderum, bởi mỗi bài viết trên spiderum thường tốn nhiều thời gian để đọc, ngiền ngẫm, cho đến việc thao khảo các bình luận của người khác . Vậy nên mình chọn cách mở rộng hơn diện tích mỗi bài viết trong danh sách: Phải có đủ không gian để hiển thị được hình ít nhất là một phần, phải có description, thông tin về tác giả cũng phải rõ ràng và đầy đủ nhất, thông tin số phút đọc, số lượt xem và bình luận cũng không kém</div><div><br></div><div><figure class="alignleft"><img src="https://s3-ap-southeast-1.amazonaws.com/images.spiderum.com/sp-images/e2192000101011eaa8085d69f5fc0785.gif" class="fr-fic fr-dib"><figcaption class="image-description" placeholder="Chú thích ảnh (không bắt buộc)" contenteditable="false"><br></figcaption></figure></div><div>&nbsp; &nbsp; Vì không gian trên thanh header còn nhiều nên mình quyết định đưa các tin top lên phần header của ứng dụng để dễ dàng truy cập đến.</div><div><br></div><div>&nbsp; &nbsp; &nbsp; Hiệu ứng loading tin được thêm vào để để trông hiện đại hơn.</div><div><br></div><div>&nbsp; &nbsp; &nbsp; Cuối cùng sau khi load được bài viết nếu người dùng quay lại vào lần sau nhưng có vấn đề về kết nối thì ứng dụng sẽ show ra các bài viết từ lần load trước đó và cũng có thể đọc được . Ngoài ra nêu kéo xuống dưới cùng bài viết cũng được load thêm</div><div><br></div><div><br></div><div><br></div><div><br></div><div><br><br><br><br></div><div><br><br><br><br><br></div><div><br></div><div><strong>b. Trang đọc bài viết</strong></div><div>So với tranh danh sách bài viết trang này thậm chí còn quan trọng hơn nhiều. Mục tiêu của mình với trang này là :</div><div><br>&nbsp;+ Hiển thị được đầy đủ bài viết: bao gồm text, hình ảnh, video, cũng như các thành phần bổ trợ khác như in đậm, heading, ...</div><div><br>&nbsp;+ Hiển thị thông tin về người viết bài, thông tin chung về số lần đọc, comment, ...</div><div><br>&nbsp;+ Đối với trang web như spiderum thì comment của người dùng cũng là 1 tài nguyên quan trọng. Nên mình tập trung hiển thị đầy đủ thông tin này (cũng vì thói quen bản thân là thích đọc comment :) )</div><div><br>&nbsp;+ Vì đây là trang mà người sử dụng dành nhiều thời gian nên hiệu ứng cực kì quan trọng nó làm mình không cảm thấy nhàm chán khi ra vào nhiều lần: hiệu ứng loading, hiệu ứng parallax</div><div><br>&nbsp;+ Đặc biệt phần "continue reading" cũng là phần mà mình đặc biệt chú trọng. Thay vì phải đọc sau đó thoát ra chọn bài viết, mình muốn người đọc có thể tiếp tục đọc các bài viết mà không phải di chuyển giữa các màn hình quá nhiều</div><div><br>&nbsp;+ Ngoài ra trang phải loading nhanh và có thể custom cỡ chữ, đánh bookmark cũng là yêu cầu cần làm</div><div><br>&nbsp;+ Cuối cùng hiệu ứng "Share element" hay còn gọi là "Hero" là hiệu ứng mình thích nhất và bắt buộc phải có trên các ứng dụng mình làm &lt;3<br><br>    Về công nghệ ban đầu mình chỉ định hiển thì trên webview, tuy nhiên nó chậm, khó custom và cũng khó implement hiệu ứng vào . Vì vậy mình quyết định parse bài viết ra code mà native android có thể hiểu được và hiển thị . Do chưa thể test hết toàn bộ bài viết nên mình nghĩ phần này còn khá nhiều bug và phần này cũng là phần tốn nhiều time nhất của mình</div><div><br></div><div><figure class="alignleft"><img src="https://s3-ap-southeast-1.amazonaws.com/images.spiderum.com/sp-images/1cb13fb0101411ea887403bbdcfba5c0.gif" class="fr-fic fr-dib"><figcaption class="image-description" placeholder="Chú thích ảnh (không bắt buộc)" contenteditable="false"><br></figcaption></figure></div><div><figure class="alignright"><img src="https://s3-ap-southeast-1.amazonaws.com/images.spiderum.com/sp-images/74bc9dd0101411ea8c0a1d0af190a2a5.gif" class="fr-fic fr-dib"><figcaption class="image-description" placeholder="Chú thích ảnh (không bắt buộc)" contenteditable="false"><br></figcaption></figure></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br></div><div><br><span class="fr-video fr-fvc fr-dvb fr-draggable" draggable="true" contenteditable="false"><iframe src="//www.youtube.com/embed/xq_XO6EhrHk?wmode=opaque" allowfullscreen="" style="width: 800px; height: 600px;" frameborder="0"></iframe></span><br><br></div><div>( Còn tiếp )</div></div>