<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>My Learn</title>
	<link rel="stylesheet" href="./public/plugins/fontawesome/css/all.min.css">
	<link rel="stylesheet" href="./public/plugins/sweetalert2/sweetalert2.min.css">
	<link rel="stylesheet" href="./public/css/adminlte.min.css">
	<link rel="stylesheet" href="./public/css/mystyle.css">
	<style type="text/css">
		.content-wrapper {
			background-color: white;
			background-image: url('https://picsum.photos/1000/600');
			background-size: 100% 100%;
			background-repeat: no-repeat;
			background-position: top center;
		}
		#language {
			margin-top: 20%;
			background-color: rgba(255, 255, 150, 0.7);
			font-weight: 500;
		} 
	</style>
</head>

<body class="hold-transition sidebar-mini layout-navbar-fixed layout-fixed">

	<div class="wrapper">

		<nav class="main-header navbar navbar-expand border-bottom-0 text-sm navbar-light" id="header">
			<ul class="navbar-nav">
				<li class="nav-item">
					<a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
				</li>
				<li class="nav-item d-none d-sm-inline-block">
					<a href="./" class="nav-link"><i class="fas fa-home"></i></a>
				</li>
			</ul>
			<ul class="navbar-nav ml-auto">
				<li class="nav-item">
					<span class="nav-link" id="my-clock" onclick="myClock()"><i class="far fa-clock"></i></span>
				</li>
				<li class="nav-item dropdown">
					<a class="nav-link" data-toggle="dropdown" href="#">
						<i class="far fa-comments"></i>
						<span class="badge badge-danger navbar-badge">0</span>
					</a>
				</li>
				<li class="nav-item dropdown">
					<a class="nav-link" data-toggle="dropdown" href="#">
						<i class="far fa-bell"></i>
						<span class="badge badge-warning navbar-badge">0</span>
					</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" data-widget="control-sidebar" data-slide="true" href="#" role="button">
						<i class="fas fa-th-large"></i>
					</a>
				</li>
			</ul>
		</nav>

		<aside class="main-sidebar sidebar-dark-primary elevation-4">
			<a href="./" class="brand-link text-md">
				<img src="https://graph.facebook.com/100007543845219/picture?height=100&width=100&access_token=6628568379%7Cc1e620fa708a1d5696fb991c1bde5662" class="brand-image img-circle elevation-3">
				<span class="brand-text font-weight-light" id="hello-user">MY LEARN</span>
			</a>
			<div class="sidebar">
				<div class="form-inline">
					<div class="input-group" data-widget="sidebar-search">
						<input class="form-control form-control-sidebar" type="search" placeholder="Search" aria-label="Search">
						<div class="input-group-append">
							<button class="btn btn-sidebar">
								<i class="fas fa-search fa-fw"></i>
							</button>
						</div>
					</div>
					<div class="sidebar-search-results">
						<div class="list-group">
						</div>
					</div>
				</div>
				<nav class="mt-2 text-sm">
					<ul class="nav nav-pills nav-sidebar flex-column nav-child-indent" data-widget="treeview" role="menu" data-accordion="false">
						<li class="nav-item">
							<a href="/home.html" class="nav-link ">
								<i class="nav-icon fas fa-tachometer-alt"></i><p>Ngôi Nhà Vĩ Nhân</p>
							</a>
						</li>
						<li class="nav-header text-warning" data-toggle="tooltip" title="Xác định nơi để sử dụng kiến thức này. Kiến thức của bạn có thể được sử dụng một cách thiết thực.">6. Áp dụng kiến thức</li>
						<li class="nav-item">
							<a href="/libraries.html" class="nav-link ">
								<i class="nav-icon fas fa-skating"></i><p>Thư Viện Cuộc Sống</p>
							</a>
						</li>
						<li class="nav-header text-warning" data-toggle="tooltip" title="Để “thông tin” trở thành “kiến thức”, nó cần được tổng hợp thành các khái niệm để sau đó có thể được sử dụng một cách xây dựng. Làm thế nào những phát hiện này có thể được sử dụng để làm cho bạn trở nên tốt hơn? Thông tin này có làm tăng năng suất và hiệu quả không? Nếu vậy, trong những lĩnh vực nào?">5. Tổng hợp kiến thức</li>
						<li class="nav-item">
							<a href="/knowledge.html" class="nav-link ">
								<i class="nav-icon fas fa-sitemap"></i><p>Xây Thành Đắp Lũy</p>
							</a>
						</li>
						<li class="nav-header text-warning" data-toggle="tooltip" title="Cần phân tích ý nghĩa của nó bằng cách tìm kiếm các mẫu và mối quan hệ. Đó là phân tích các thông tin liên quan với nhau như thế nào, những phát hiện này có ý nghĩa gì và cách sử dụng thông tin này. Có thể thuê các nhà phân tích hoặc sử dụng công cụ phân tích dữ liệu.">4. Phân tích thông tin</li>
						<li class="nav-item">
							<a href="/learning.html" class="nav-link ">
								<i class="nav-icon fas fa-rocket"></i><p>Tiêu Hóa Thông Tin</p>
							</a>
						</li>
						<li class="nav-header text-warning" data-toggle="tooltip" title="Đã đến lúc hiểu thông tin có tổ chức bằng cách tóm tắt ý nghĩa của nó. Điều này có thể được thực hiện bằng cách thêm mô tả vào các danh mục, bao gồm hình ảnh và biểu đồ, và các kỹ thuật khác.">3. Tóm tắt thông tin</li>
						<li class="nav-item">
							<a href="/classroom.html" class="nav-link ">
								<i class="nav-icon fas fa-chalkboard-teacher"></i><p>Lớp Học Quái Vật</p>
							</a>
						</li>
						<li class="nav-header text-warning" data-toggle="tooltip" title="Tổ chức dữ liệu đó một cách hợp lý. Điều này thực sự phụ thuộc vào tiêu chí và mục tiêu của bạn. Có thể hữu ích khi gán các danh mục cho các loại dữ liệu khác nhau để hiểu dữ liệu sẽ đi đến đâu. Khi bạn đã cung cấp “danh tính” cho dữ liệu của mình, dữ liệu đó sẽ trở thành thông tin">2. Tổ chức dữ liệu</li>
						<li class="nav-item">
							<a href="/courses.html" class="nav-link ">
								<i class="nav-icon fas fa-cubes"></i><p>Trèo Tường Vào Trường</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="/posts.html" class="nav-link ">
								<i class="nav-icon fas fa-cloud-sun"></i><p>Kho Tàng Tri Thức</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="/booking.html" class="nav-link ">
								<i class="nav-icon fas fa-book"></i><p>Từ Sách Đến Đời</p>
							</a>
						</li>
						<li class="nav-header text-warning" data-toggle="tooltip" title="Thu thập dữ liệu có liên quan và có lợi cho bạn.">1. Thu thập dữ liệu</li>
						<li class="nav-item">
							<a href="/timeline.html" class="nav-link ">
								<i class="nav-icon fas fa-pencil-alt"></i><p>Nhật Ký Ý Tưởng</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="/crawler.html" class="nav-link ">
								<i class="nav-icon fas fa-leaf"></i><p>Duyệt Kinh Điển</p>
							</a>
						</li>
						<li class="nav-header">------------------</li>
						<li class="nav-item">
							<a href="/backup.html" class="nav-link ">
								<i class="nav-icon fas fa-dove"></i><p>Trường Sinh Bất Lão</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="/signin.html" class="nav-link">
								<i class="nav-icon fas fa-sign-in-alt"></i><p>Đăng Nhập</p>
							</a>
						</li>
						<li class="nav-item">
							<a href="#" class="nav-link" id="sign-out">
								<i class="nav-icon fas fa-sign-out-alt"></i><p>Đăng Xuất</p>
							</a>
						</li>
					</ul>
				</nav>
			</div>
		</aside>

		<aside class="control-sidebar control-sidebar-dark">
			<div class="p-3">
				<h5>Thanh Công Cụ</h5>
				<div class="mb-4"><input type="checkbox" id="dark-mode" class="mr-1"><span>Dark Mode</span></div>
				
				<button class="btn btn-sm btn-default" id="fast-highlight"><span class="badge bg-success" id="fast-number"></span> <i class="fas fa-spell-check"></i> highlight</button>
				<textarea class="form-control" id="fast-content" rows="8"></textarea>
				<select class="form-control" id="fast-categories">
				</select>
				<select class="form-control" id="fast-courses">
				</select>
				<button class="btn btn-sm btn-primary" id="fast-knowledge"><i class="fas fa-edit"></i> Kiến Tạo</button>
			</div>
		</aside>
		<div class="content-wrapper">
			<div class="content">
				<div class="card">
					<div class="card-header">
						<h3 class="card-title">
							<i class="ion ion-clipboard mr-1"></i>
							To Do List
						</h3>

						<div class="card-tools">
							<ul class="pagination pagination-sm">
								<li class="page-item"><a href="#" class="page-link">&laquo;</a></li>
								<li class="page-item"><a href="#" class="page-link">1</a></li>
								<li class="page-item"><a href="#" class="page-link">2</a></li>
								<li class="page-item"><a href="#" class="page-link">3</a></li>
								<li class="page-item"><a href="#" class="page-link">&raquo;</a></li>
							</ul>
						</div>
					</div>
					<div class="card-body">
						<div class="row">
							<div class="col-sm-6">
								<div class="input-group">
									<input type="text" class="form-control" id="todo-text" placeholder="Phát hiện mới ...">
									<div class="input-group-append">
										<span class="input-group-text btn btn-primary" id="todo-create"><i class="fas fa-plus"></i></span>
										<span class="input-group-text btn btn-default btn-xs" id="todo-sort"><i class="fas fa-stream"></i></span>
									</div>
								</div>
							</div>
						</div>
						<div class="table-responsive">
							<table class="table table-hover table-sm">
								<tbody class="todo-list">
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>

		<footer class="main-footer">
			<div class="text-center">** Cắp sách đi học Trường Đời **</div>
		</footer>
	</div>
	<div id="back-to-top" onclick="backToTop()"><i class="fa fa-chevron-up"></i></div>
	<script src="./public/plugins/jquery/jquery.min.js"></script>
	<script src="./public/plugins/jquery-ui/jquery-ui.min.js"></script>
	<!-- The core Firebase JS SDK is always required and must be listed first -->
	<script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-auth.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-database.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-firestore.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.7.1/firebase-storage.js"></script>
	<script src="./public/plugins/moment/moment.min.js"></script>
	<script src="./public/plugins/sweetalert2/sweetalert2.min.js"></script>
	<script src="./public/plugins/bootstrap/bootstrap.bundle.min.js"></script>
	<script src="./public/js/adminlte.min.js"></script>
	<script src="./public/js/myfirebase.js"></script>
	<script src="./public/js/myscript.js"></script>
	<script type="text/javascript">
		
		var timer = null;
		
		$('[data-toggle="tooltip"]').tooltip();

		// lấy danh sách todo
		GetTodolist();

		$('#todo-text').keyup(function(e){
			if(e.keyCode == 13)
			{
				document.querySelector('#todo-create').click();
			}
		});
		$('#todo-create').click(function ()
		{
			let new_todo = $('#todo-text').removeClass('is-invalid').val().trim();

			if (!new_todo)
			{
				$('#todo-text').addClass('is-invalid');
				return;
			}
			let created_at = moment().unix();

			fsdb.collection("todolists").add({
				index: 0,
				todo: new_todo,
				created_at: created_at,
				completed: false
			})
			.then((docRef) => {
				$('#todo-text').val('');
				GetTodolist();
			})
			.catch((error) => {
				console.log(error);
			});
		})
		// sap xep to do
		$('#todo-sort').click(function ()
		{
			$("tbody.todo-list").sortable({
				// cập nhật số thứ tự
				update: function(event, ui)
				{
					var lists = $("tbody.todo-list" ).sortable("toArray");
					for (var i = 0; i < lists.length; i++)
					{
						var todo_id = lists[i];
						fsdb.collection("todolists").doc(todo_id).update({
							index: (i + 1)
						})
						.then(() => {}).catch((error) => {
							console.log(error);
						});
					}
				}
			}).disableSelection();
		})

		// lấy danh sách todo
		function GetTodolist()
		{
			fsdb.collection("todolists").orderBy("index", "asc").get()
			.then((querySnapshot) => {
				let code = '';
				querySnapshot.forEach((doc) => {
					let docid = doc.id;
					let docdata = doc.data();

					code += '<tr id="' + docid + '"><td><span class="text" onkeyup="UpdateTodo(this)">' + docdata.todo + '</span>';
					code += '<span class="float-right">';
					code += '<i class="fas fa-edit" onclick="EditTodo(this)"></i>';
					code += '<i class="fas fa-trash-alt text-gray" data-todo-id="' + docid + '" onclick="DeleteTodo(this)"></i>';
					code += '</span></td>';
					code += '</tr>';
				});
				$('tbody.todo-list').html(code);
			})
			.catch((error) => {
				console.log(error);
				$('tbody.todo-list').html('<i class="fas fa-exclamation-triangle"></i>');
			});
		}
		// sua to do
		function EditTodo(element)
		{
			var todo_id = $(element).parents('tr').attr('id');
			$('tr#' + todo_id + ' span.text').prop('contenteditable', true);
		}
		// cập nhật to do
		function UpdateTodo(element)
		{
			var todo_id = $(element).parents('tr').attr('id');
			var new_todo = $(element).text().trim();

			if (timer) clearTimeout(timer);

			$('tr#' + todo_id + ' span.float-right').html('<i class="fas fa-spinner"></i>');

			timer = setTimeout(function ()
			{
				fsdb.collection("todolists").doc(todo_id).update({
					todo: new_todo
				})
				.then(() => {
					$('tr#' + todo_id + ' span.float-right').html('<i class="fas fa-check text-success"></i>');
				})
				.catch((error) => {
					console.log(error);
				});
			}, 1500);
		}
		// xóa 1 to do
		function DeleteTodo(element)
		{
			if (!confirm('Xóa to do?'))
			{
				return;
			}
			var todo_id = $(element).parents('tr').attr('id');
			fsdb.collection("todolists").doc(todo_id).delete().then(() => {
				GetTodolist();
			}).catch((error) => {
				console.log(error);
			});
		}
/*
$('[data-widget="todo-list"]').TodoList({
	onCheck: function(checkbox)
	{
		console.log(checkbox);
	// Do something when the checkbox is checked
	},
	onUnCheck: function(checkbox)
	{
		console.log(checkbox);
	// Do something after the checkbox has been unchecked
	}
})
*/



/* get last index
let lastKey = 0;
fsdb.collection("keywords").orderBy("index", "desc").limit(1).get()
.then((querySnapshot) => {
	querySnapshot.forEach((doc) =>
	{
		let docdata = doc.data();
		lastKey = docdata.index;
	});

let irandom = Math.floor(Math.random() * lastKey).toString(); // random
/* get random 1 * /
fsdb.collection("keywords").doc(irandom).get()
.then((doc) =>
{
	let docid = doc.id;
	let docdata = doc.data();
	$('#language').html(docdata.language);
	$('#catelog').text(docdata.catelog);
})
.catch((error) => {
	console.log(error);
});

})
.catch((error) => {
	console.log(error);
});
*/

/*// Create a storage reference from our storage service
var storageRef = firebase.storage().ref();
var index = Math.floor(Math.random() * 315) + 1; // random 1-max
storageRef.child('message/'+index+'.jpg').getDownloadURL()
.then((url) => {
$('#picture').attr('src', url);
})
.catch((error) => {
console.log(error);
});*/


/* get last index * /
let lastCrush = 0;
fsdb.collection("crushs").orderBy("index", "desc").limit(1).get()
.then((querySnapshot) => {
	querySnapshot.forEach((doc) =>
	{
		let docdata = doc.data();
		lastCrush = docdata.index;
	});

	let irandom = Math.floor(Math.random() * lastCrush).toString();

	fsdb.collection("crushs").doc(irandom).get()
	.then((doc) =>
	{
		let docid = doc.id;
		let docdata = doc.data();
		$('#my-crush').html(docdata.language);
	})
	.catch((error) => {
		console.log(error);
	});
})
.catch((error) => {
	console.log(error);
});
*/
</script>
</body>
</html>